# LottoGoGo 테스트 계획서 (TEST_PLAN.md)

## 1. 테스트 전략 개요

### 테스트 피라미드
```
        ┌───────────────┐
        │    E2E (5%)   │  ← 전체 파이프라인 통합
        ├───────────────┤
        │ Integration   │  ← 컴포넌트 간 연동
        │    (25%)      │
        ├───────────────┤
        │     Unit      │  ← 개별 함수/클래스
        │    (70%)      │
        └───────────────┘
```

### 테스트 환경
- **Framework**: pytest
- **Coverage 목표**: 85% 이상
- **CI/CD**: GitHub Actions

---

## 2. 단위 테스트 (Unit Tests)

### 2.1 데이터 레이어
| 테스트 ID | 대상 | 설명 | 우선순위 |
|-----------|------|------|----------|
| UT-D001 | CSVLoader.load() | 정상 CSV 파싱 | P0 |
| UT-D002 | CSVLoader.validate() | 번호 범위 검증 (1-45) | P0 |
| UT-D003 | CSVLoader.validate() | 컬럼 누락 에러 | P0 |
| UT-D004 | ConfigManager.load() | YAML 파싱 | P1 |
| UT-D005 | ConfigManager.get() | 기본값 반환 | P1 |

### 2.2 점수 엔진
| 테스트 ID | 대상 | 설명 | 우선순위 |
|-----------|------|------|----------|
| UT-S001 | BayesScore.calculate() | Beta prior 적용 | P0 |
| UT-S002 | BayesScore.calculate() | 경계값 (0회, N회) | P0 |
| UT-S003 | BoostLayer.hot() | Hot 조건 충족 | P0 |
| UT-S004 | BoostLayer.cold() | Cold 조건 충족 | P0 |
| UT-S005 | BoostLayer.neighbor() | ±1 이웃 판정 | P1 |
| UT-S006 | PenaltyLayer.poisson() | 과출현 페널티 | P0 |
| UT-S007 | PenaltyLayer.markov() | 전이 페널티 | P1 |
| UT-S008 | Softmax.normalize() | 확률 합 = 1 | P0 |
| UT-S009 | Softmax.floor() | MIN_PROB 적용 | P0 |

### 2.3 조합 생성
| 테스트 ID | 대상 | 설명 | 우선순위 |
|-----------|------|------|----------|
| UT-G001 | Sampler.sample() | 6개 번호 반환 | P0 |
| UT-G002 | Sampler.sample() | 중복 없음 검증 | P0 |
| UT-G003 | Sampler.sample() | seed 재현성 | P0 |

### 2.4 필터
| 테스트 ID | 대상 | 설명 | 우선순위 |
|-----------|------|------|----------|
| UT-F001 | SumFilter.apply() | 합계 100-175 통과 | P0 |
| UT-F002 | SumFilter.apply() | 합계 99 탈락 | P0 |
| UT-F003 | ACFilter.apply() | AC값 7 이상 통과 | P0 |
| UT-F004 | OddEvenFilter.apply() | 2:4 ~ 4:2 통과 | P1 |
| UT-F005 | HistoryFilter.apply() | 5개 일치 탈락 | P1 |

---

## 3. 통합 테스트 (Integration Tests)

| 테스트 ID | 대상 컴포넌트 | 설명 | 우선순위 |
|-----------|---------------|------|----------|
| IT-001 | CSVLoader → ScoreEngine | 데이터 → 점수 흐름 | P0 |
| IT-002 | ScoreEngine → Sampler | 확률 → 샘플링 | P0 |
| IT-003 | Sampler → FilterPipeline | 후보 → 필터링 | P0 |
| IT-004 | FilterPipeline → Ranker | 필터 → 랭킹 | P1 |
| IT-005 | 전체 Config 적용 | Config 주입 검증 | P1 |

---

## 4. E2E 테스트 (End-to-End Tests)

| 테스트 ID | 시나리오 | 설명 | 우선순위 |
|-----------|----------|------|----------|
| E2E-001 | 정상 파이프라인 | CSV → 추천 5조합 | P0 |
| E2E-002 | 빈 CSV | 에러 처리 검증 | P1 |
| E2E-003 | 백테스트 실행 | 지표 출력 검증 | P1 |
| E2E-004 | 재현성 검증 | 동일 seed → 동일 결과 | P0 |

---

## 5. 핵심 테스트 10개 (Critical Path)

> **반드시 통과해야 MVP 릴리즈 가능**

| # | 테스트 ID | 설명 | 검증 포인트 |
|---|-----------|------|-------------|
| 1 | UT-D001 | CSV 정상 로딩 | 회차 데이터 정확성 |
| 2 | UT-S001 | 베이지안 점수 계산 | 수학적 정확성 |
| 3 | UT-S003 | Hot 번호 판정 | 휴리스틱 정확성 |
| 4 | UT-S006 | Poisson 페널티 | 통계모델 정확성 |
| 5 | UT-G002 | 중복 없는 샘플링 | 6개 고유 번호 |
| 6 | UT-G003 | Seed 재현성 | 결정론적 결과 |
| 7 | UT-F001 | 합계 필터 | 필터 정확성 |
| 8 | IT-002 | 점수→샘플링 연동 | 데이터 흐름 |
| 9 | E2E-001 | 전체 파이프라인 | 통합 기능 |
| 10 | E2E-004 | 재현성 E2E | 전체 결정론 |

---

## 6. 경계값 테스트 (Boundary Value Analysis)

### 6.1 번호 범위
| 케이스 | 입력 | 예상 결과 |
|--------|------|-----------|
| 최소 유효값 | 1 | 정상 처리 |
| 최대 유효값 | 45 | 정상 처리 |
| 하한 경계 위반 | 0 | 에러 |
| 상한 경계 위반 | 46 | 에러 |

### 6.2 합계 필터
| 케이스 | 입력 합계 | 예상 결과 |
|--------|-----------|-----------|
| 하한 -1 | 99 | 탈락 |
| 하한 경계 | 100 | 통과 |
| 상한 경계 | 175 | 통과 |
| 상한 +1 | 176 | 탈락 |

### 6.3 AC값 필터
| 케이스 | AC값 | 예상 결과 |
|--------|------|-----------|
| 경계 -1 | 6 | 탈락 |
| 경계값 | 7 | 통과 |
| 경계 +1 | 8 | 통과 |

### 6.4 홀짝 비율
| 케이스 | 홀:짝 | 예상 결과 |
|--------|-------|-----------|
| 경계외 | 1:5 | 탈락 |
| 하한 경계 | 2:4 | 통과 |
| 상한 경계 | 4:2 | 통과 |
| 경계외 | 5:1 | 탈락 |

### 6.5 회차 데이터
| 케이스 | 조건 | 예상 결과 |
|--------|------|-----------|
| 최소 회차 | N=1 | 정상 (prior 의존) |
| 기준 회차 | N=50 | 정상 처리 |
| 대량 회차 | N=1000 | 성능 테스트 |

---

## 7. 성능 테스트 기준

| 항목 | 목표 | 측정 방법 |
|------|------|-----------|
| 점수 계산 | < 100ms (45번호) | pytest-benchmark |
| 샘플링 100K | < 5s | time 측정 |
| 필터 파이프라인 | < 1s (100K 후보) | time 측정 |
| 전체 추천 | < 10s | E2E time |
